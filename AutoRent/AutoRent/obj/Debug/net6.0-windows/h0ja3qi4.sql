DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'AutoRent.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202205061500535_AddDb'
BEGIN
    CREATE TABLE [dbo].[AutoRent_Car] (
        [ID] [int] NOT NULL IDENTITY,
        [Name] [int] NOT NULL,
        [PriceForContract] [decimal](18, 2) NOT NULL,
        [TypeID] [int],
        [FuelID] [int],
        [TransmissionID] [int] NOT NULL,
        CONSTRAINT [PK_dbo.AutoRent_Car] PRIMARY KEY ([ID])
    )
    CREATE INDEX [IX_TypeID] ON [dbo].[AutoRent_Car]([TypeID])
    CREATE INDEX [IX_FuelID] ON [dbo].[AutoRent_Car]([FuelID])
    CREATE INDEX [IX_TransmissionID] ON [dbo].[AutoRent_Car]([TransmissionID])
    CREATE TABLE [dbo].[AutoRent_Fuel] (
        [ID] [int] NOT NULL IDENTITY,
        [FuelType] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_Fuel] PRIMARY KEY ([ID])
    )
    CREATE TABLE [dbo].[AutoRent_Transmission] (
        [ID] [int] NOT NULL IDENTITY,
        [TransmissionType] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_Transmission] PRIMARY KEY ([ID])
    )
    CREATE TABLE [dbo].[AutoRent_Type] (
        [ID] [int] NOT NULL IDENTITY,
        [CarType] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_Type] PRIMARY KEY ([ID])
    )
    CREATE TABLE [dbo].[AutoRent_Contract] (
        [ID] [int] NOT NULL IDENTITY,
        [UserID] [int] NOT NULL,
        [CarID] [int] NOT NULL,
        [ContractPrice] [decimal](18, 2) NOT NULL,
        [DeliveryAddressID] [int],
        CONSTRAINT [PK_dbo.AutoRent_Contract] PRIMARY KEY ([ID])
    )
    CREATE INDEX [IX_UserID] ON [dbo].[AutoRent_Contract]([UserID])
    CREATE INDEX [IX_CarID] ON [dbo].[AutoRent_Contract]([CarID])
    CREATE INDEX [IX_DeliveryAddressID] ON [dbo].[AutoRent_Contract]([DeliveryAddressID])
    CREATE TABLE [dbo].[AutoRent_DeliveryAddress] (
        [ID] [int] NOT NULL IDENTITY,
        [City] [nvarchar](max),
        [Street] [nvarchar](max),
        [Building] [nvarchar](max),
        [Discription] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_DeliveryAddress] PRIMARY KEY ([ID])
    )
    CREATE TABLE [dbo].[AutoRent_User] (
        [ID] [int] NOT NULL IDENTITY,
        [Surname] [nvarchar](max),
        [Lastname] [nvarchar](max),
        [Login] [nvarchar](max),
        [Password] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [DriverLicenseNumber] [nvarchar](max),
        [RoleID] [int],
        [PassportID] [int],
        CONSTRAINT [PK_dbo.AutoRent_User] PRIMARY KEY ([ID])
    )
    CREATE INDEX [IX_RoleID] ON [dbo].[AutoRent_User]([RoleID])
    CREATE INDEX [IX_PassportID] ON [dbo].[AutoRent_User]([PassportID])
    CREATE TABLE [dbo].[AutoRent_Passport] (
        [ID] [int] NOT NULL IDENTITY,
        [Series] [nvarchar](max),
        [Number] [nvarchar](max),
        [IssuePlace] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_Passport] PRIMARY KEY ([ID])
    )
    CREATE TABLE [dbo].[AutoRent_Role] (
        [ID] [int] NOT NULL IDENTITY,
        [RoleName] [nvarchar](max),
        CONSTRAINT [PK_dbo.AutoRent_Role] PRIMARY KEY ([ID])
    )
    ALTER TABLE [dbo].[AutoRent_Car] ADD CONSTRAINT [FK_dbo.AutoRent_Car_dbo.AutoRent_Fuel_FuelID] FOREIGN KEY ([FuelID]) REFERENCES [dbo].[AutoRent_Fuel] ([ID])
    ALTER TABLE [dbo].[AutoRent_Car] ADD CONSTRAINT [FK_dbo.AutoRent_Car_dbo.AutoRent_Transmission_TransmissionID] FOREIGN KEY ([TransmissionID]) REFERENCES [dbo].[AutoRent_Transmission] ([ID]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AutoRent_Car] ADD CONSTRAINT [FK_dbo.AutoRent_Car_dbo.AutoRent_Type_TypeID] FOREIGN KEY ([TypeID]) REFERENCES [dbo].[AutoRent_Type] ([ID])
    ALTER TABLE [dbo].[AutoRent_Contract] ADD CONSTRAINT [FK_dbo.AutoRent_Contract_dbo.AutoRent_Car_CarID] FOREIGN KEY ([CarID]) REFERENCES [dbo].[AutoRent_Car] ([ID]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AutoRent_Contract] ADD CONSTRAINT [FK_dbo.AutoRent_Contract_dbo.AutoRent_DeliveryAddress_DeliveryAddressID] FOREIGN KEY ([DeliveryAddressID]) REFERENCES [dbo].[AutoRent_DeliveryAddress] ([ID])
    ALTER TABLE [dbo].[AutoRent_Contract] ADD CONSTRAINT [FK_dbo.AutoRent_Contract_dbo.AutoRent_User_UserID] FOREIGN KEY ([UserID]) REFERENCES [dbo].[AutoRent_User] ([ID]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AutoRent_User] ADD CONSTRAINT [FK_dbo.AutoRent_User_dbo.AutoRent_Passport_PassportID] FOREIGN KEY ([PassportID]) REFERENCES [dbo].[AutoRent_Passport] ([ID])
    ALTER TABLE [dbo].[AutoRent_User] ADD CONSTRAINT [FK_dbo.AutoRent_User_dbo.AutoRent_Role_RoleID] FOREIGN KEY ([RoleID]) REFERENCES [dbo].[AutoRent_Role] ([ID])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202205061500535_AddDb', N'AutoRent.Migrations.Configuration',  0x1F8B080000000000000AEC5DDB6EE4B8117D0F907F10F49404B36EDBF3B231DABB70EC7160ECCCD8707B17791BD012DD16A24B4797898D205F96877C527E21A4A80BEF22A566B77AC608B018AB595564D561912CB22AFFFBCF7F973FBF24B1F715E64594A5E7FEC9D1B1EFC134C8C2285D9FFB55F9F4C38FFECF3FFDFE77CB0F61F2E2FDD6B67B8FDB21CAB438F79FCB7273B65814C1334C40719444419E15D953791464C90284D9E2F4F8F8CF8B939305442C7CC4CBF396F7555A4609ACFF407F5E666900376505E24F5908E3A2F98E7E59D55CBDCF2081C50604F0DCBFA8CAEC1EA6A5EF5DC41140F257307EF23D90A659094AD4BBB35F0BB82AF32C5DAF36E803881F5E3710B57B0271019B5E9FF5CD4D07707C8A07B0E8095B564155945962C9F0E47DA391054F3E4AAF44AD8DCE3E20DD96AF78D4B5DE7A957DB904B9EFF102CF2EE31C37EEDB1DD104EFBCF6AF779DFD114CF0FFDE7997555C56393C4F6155E6207EE7DD558F7114FC025F1FB2BFC3F43CADE298EE1BEA1DFA8DF9803EDDE5D906E6E5EB3D7C6A7A7C73E57B0B966EC1137664140D19C74D5ABE3FF5BDCF4838788C61677A6ACCAB32CBE15F610A7350C2F00E9425CC91E56E42582B4F90CEC9C2FF1D92A6E770974701BCCE72047DA4B9A06CB95DC1204A40EC7B7739FA57332B7FF4BD5500306F7B4198ADA01A3DC97505634B92871CA4451215B8C3C386E0787D065FA3756D178E6B8743DC23DFBB8771DDAA788E3664DE3348FDC235BFCEB3E43EC362D5ADBEACB22A0FB02DB3C1A60F205FC37244EF69E5588C82251B1A0DDDDA70540CC9F8D12153DB8CAA6E3E381AD4CA7414B8A9ACF7CB45EF09CDFC23C18D8D83C4146F1E52E14388A989EAD08A8CB614BEF709BC7C84E9BA7C3EF7D13F1110A21718B65F1AF7F06B1AA11D08222AF30A4EB5293B8B6C6C4B53BED978C0E9CFC3D67527AC6C8CBEBFD956625BE4626761D27E7F64B56F6DA8DE4C2B312D3A1FE5D67B34111E93593436AA77C2CEB6BF57308ED0F1F6F5220C73581443DBDAE1ED4E7D86D2EE769A717D6149643B1E594BCDAE47DA7CF4BE8DD38CEDA00472A30172543683E549470F1CE3DF76B484C66888B8A9CDB8EAF6DBD9BF0A36B1F1991CF19BEB94F9AC3A36B0D52551148218438C05C762FE5245310EF33917741515411E6D48706BCFDB09328F6DA605A6789B0B329856794A85C19CC1E72328CADD08CAD6D1B6112A09FC81A2F8679687EE053D6729FC5C258F18F1AEA7788E978E8F68239716BB92891756CB2825D6FD26CBCBE9BBC096937E1F512FED121AC93E42DE54BD8F50B41FBD29C2EC6D0643DA0F0E04FF683A88BAED763642BDAA6D5C7D4BF5E6EE65EE1EE6112C9CCFEA1D398F9BA2A8E05D8C6E14F7BE252133C906A798E20DA38A2581BE9A736CD38BA2C882A83697244AC05D47B170FC90869EF9DD14190C7FA782C685AE5FA30DBA70459D3BF7FF2480DE484AEB716552C885082BE6F8E8E8449084AE6E618EEF4E418C4EB8053AE2466929DEF34669106D406CDC298E83E15D31B658278BFFE50A6E608AAF798DF56FD289F6CA54EC48278FBBCE1ED2D87241C16B0CEA988B0F3B5CC8EF125DA1507A0D2993C65EE5B0624F78332D6F5314D18025F42E02F22CE312140108C5A501CDEED0199A6583DB1BAA657635E90C7FBB3F2794E34B0A4BBC3177CBCE504D5F4B4BD15C5FAFECD6B7D29DDA1F0A29FD1BA1AF79C1B267D449C3FAC398D0C7F865E8EB6EBCC640507B476008F639F952DD78768A609D1D4D3AD2DC98CD0DC4FC95C1088429EF74DC835B752724132D5C8EB877BDA6FDDD2F9015F633E994E47675BF005744DC06A135147E93E0895C258C80F140E84E26AB8F673907ADBE77BB44AADE26263DA1E3BD73C2E53D0EF958E204FFB80B3CD6727458AC3BBF6B1CD2BDDA1F06691B98F402B7DF3FF614AF19462CB7ECD306F7CB3BF334C214F3B3DEBDD223DAEFAA4FDBD2A427EDABB11D6099445B71971105CCA9F762F04576A583BAD644CB8B267CCB630DF35BC1B2E104A82D3CDA07F6C15DE9D96861C80C8700B5DC4830D5941D1D73D1B265A362C6ECB1B6B46CEBF08429BB165F7A7576DEC1942DB7BFD4F758D8E09B4AC1D0D672266EC6945DBBEBD0B2EC7774A66CF18CD6B2240B33C78E9A623D4FCD358547110CE7D8F0BEC0EA5AA31BA93023051F63759121E3DB4C4EDEDFB3DA19AD39760A9A6A501DA01F1BA2DFA246A54179197FCE4FB9D270ED8D8C352B04856DC3C2DBD4241D08966A90B8E22D6A4EFE0259A7BDE1E0E698F0A6548BFD4A61A44A6D40D3D44CDBD5A6B0D05869561B719B1A7373A27155944D264CB2626FCF14AAF7541AFD9B048446858464836F3612265A1E0802C9B853FB0A572A255B0863758A710CEB48C656D5C8C42E649C9B3D944BE740F68A561E413C8E8F3A903B99FBCC11DCD8581A95B68F69BAE35DF7DB7241AA3D341F960B455988E527B0D9A0773D549988E68BB72235222E7F58D9975148088F45C0B864FE30DA492AB31CAC21F72B3EA586F03ACA8BF20A94E011E0974597612269460EB38ABD7F2B45765E15CDD81E085A2AFC6F16A7EC91563CEE3794D76848098E1ED4E511286BEBC911039C9F0572494586CB2CAE92541DCC505393875C343DF962CE41ACB14073137F35E7DC5E49D3FC54D7D46A2EEDA3219A8BEA2191A62FDCE30CA64F030F37F02CE36C2F8477047C09313316B476902607B36998961D456D407D2DA577836A2C8B1C6678ABCB022E73B0107BC09B6629DD91D7C6627A3E6E2C2766BBAB66DA6C2D591F34275A5072B4B6B29C94DE8DC5BA1C769A45F7717EF6E9376B13D7F876459BB2D02B79B8B1557BBD4073505D39682DCE3351BCBBD1F060F3D2195EEC4FE63C25EF2468BE06CF28F68F4EF1643F0DA50371101BB00EB272E45FEA6C60062092DA613A0E6DAA2FCDA3FD66CEA5CFE4A5F9F45F2D704AA7EA3208A57F981F36C921741A1E65A7701B10CAE9DD20AFCBBD6580D37E34E7D3E7D6D28CFAAF169C48F22CC3867CB238AF75A9B1CC39ADFB6AC189CE7D6598D13F58CC0B597E2B333F640DCCF9B70F456896AAC7237AFDB5CF9D780DAA9E41ED7FEEF661CD69F35715DBB599C36A1E8EE6719354C94CE3E69B45A44402487B0CD22991CC88A8EFF3430F89E84E438E2C8C6D831A39BD1BC460596264ACFFBA630B09D15CBE4927BD8BEA72D1DB6513491DAEFC2B845649135C2B2AFB1A8538ACBA7A2D4A981CE10647AB7FC4977184C6DB37F804D2E8091625294EEB9F1E9F9C726584E753D2775114616C51D777E75576D1632EDF1BACA36B59AE8B809812B0A5B2BAA1DBB2BA755785776937E855DCCBB9FFAF9AE4CCBBF95B1DFDB8B97AE7DDE6088D67DEB1F76F5AB049E23A8E14DACB255453E4CA0BFC1A8F9BA156F543A2F891355CBF8DC9D047858990F42BC8836790FF21012F7FD41B70629DD46F437FAAFAA4A9533D8A09A9BF1CA8FEB81AA04ED5268F371EACEAD81A9BA66E925059B847A9CDECE5D644D3C4CA8A79863B2BE6693A508181F99238BD1AE3B7816CBA04A28547182A733889155FCA70123349B942A79E4F928C73A8D8E04A024E32035FF66F1A33BAB4DF244E7CF9BE69CCC4127DD3A0AB2EC337896F1B8AB473B6846ACAA143ACD7672ABBA774E9E115F9C5073B7D99126F9310B345F089A5DA9CBA63496EEEA1DAB38F0A6E4D6FDB2D7956B79A56784C9E7D31A1AECFB48C4FF95332B79575BE8F02656C8ED57022A4C3A4E099616EE051DDFEB177F0E5C3E828C8C8225E73C38CFC19DF0CB0A278457D18C5BE2C2CEADC23713720630B354CAE3EB7973A07DF55492E211FD1283B7EA4D39A05AC86DF0ECE046257DF4A81AC3ED9525FCD601CAA48D29CBAF4825B34695E0EB9AD2CF41D14B12219A5EA7215878817C57BA11960E5B00B4ED959F5FBD840199B7E2FCBDB0C8A42F1E9B6FA6A3AEC8E7CA0F213795F86EE311F330402122A635B2C0CA59170D6506928AD3CD2C454201B0B312D1EA5ED80559D29EE803C54664A2F5892AEA5316C37314D0A51E94D6C5AAF4ABDC9B6A856A5ED8AD0DAB447C4730E95B6D2CA36AA7E25D90A9A14BFD20A36AE91C5ED29864A646985CEB38A16ED4024C9CB66C51D7A972726F51F76692C99BBD3640CCF585D4EEA5CD14E58928E3B2F75ECB07895C59086F688DA1C5AA7EAD979352AC522A74FC99CA93A775A518A5F1A15B94746AAA2D775491EE2A15588A2176E4972CDCC54B2D3AA4F76C3DAD1C4B2A8E224E6F7A0536085A813F2B2001D458B68DDB358229E29AC4FF03DD3B6CD4DFA94B5C750AE476D13EE11C4275882101D0E2FF2327AAA5FA866017248F56BC1DF405CA1261FD05B95F026BDADCA4D55A221C3E43166D2B8F1715627BF2E55C5F679795BBF202CB63104D4CD080D01DEA6F543C7AEDFD7927C09050B7C4E6E5E96605B227397708DC6D870FA8CDEA199316AD4D71DEF1F60B241FF9FA1B0B84D57E02B6262DF3704E38F700D82D7364D4BCD64D810ACDA97571158E720291A1E3D3DFA1361384C5E7EFA3F000000FFFF030063BC7ED5068F0000 , N'6.4.4')
END

